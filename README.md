# ADBOX - доска объявлений

Веб-приложение на Angular для просмотра и размещения объявлений. Реализована возможность авторизации и регистрации пользователей, изменения настроек пользователей.

## Установка и запуск проекта

1. Клонируйте репозиторий:

```bash
git clone https://github.com/pavelisik/adbox.git
```

2. Перейдите в директорию проекта:

```bash
cd adbox
```

3. Установите зависимости:

```bash
npm install
```

4. Запустите проект в режиме разработки:

```bash
npm start
```

5. Откройте приложение в браузере по адресу:

```
http://localhost:4200
```

## Структура проекта

Директория **core** - низкоуровневые сущности, необходимые для работы всего приложения:

- `auth` - необходимые для авторизации сервисы и интерфейсы доменов авторизации:
    - `auth.service` - общий сервис для авторизации, разлогинивания и подтверждения пароля;
    - `auth.state.service` - сервис состояния авторизации, работа с токеном авторизации, синхронизация с cookie;
    - `users.service` - общий сервис для пользователей;
    - `users.store.service` - сервис, определяющий текущего пользователя.
- `guards` - защитники навигации:
    - `auth.guard` - защитник для авторизованных и неавторизованных пользователей.
- `interceptors` - перехватчики запросов:
    - `constants`
        - `error-messages` - словарь ошибок сервера в соответствии с проектом;
        - `error-titles.enum` - стандартные заголовки ошибок в зависимости от статуса запроса.
    - `utils`
        - `format-error-response.util` - форматирование информации серверной ошибки для вывода.
    - `auth.interceptor` - перехватчик запросов для авторизованных пользователей с добавлением токена авторизации;
    - `errors.interceptor` - перехватчик запросов для вывода toast-сообщений об ошибках;
    - `images-cache.interceptor` - перехватчик GET-запросов для кэширования полученных Blob-изображений.
- `notification`
    - `notification.service` - сервис, формирующий toast-сообщения.
- `confirmation`
    - `confirmation.service` - сервис, формирующий confirm-сообщения;
    - `password-confirmation.service` - сервис для работы логики подтверждения пароля.
- `dialog`
    - `dialog.service` - сервис для работы с диалоговыми окнами.

Директория **infrastructure** - сервисы для работы с API, интерфейсы DTO и адаптеры преобразования интерфейсов из DTO в бизнес-домены:

- `advert` - объявления;
- `authorization` - авторизация;
- `categories` - категории;
- `comment` - комментарии;
- `images` - изображения для объявлений;
- `users` - пользователи.

Директория **pages** - компоненты отдельных страниц с интерфейсами бизнес-доменов:

- `advert` - страница отображения объявления по его id;
- `advert-add` - страница с формой добавления нового объявления;
- `adverts-list` - страница со списком всех объявлений: условно отображает объявления на главной странице, результаты поиска с различными фильтрами и объявления пользователя;
- `not-found` - страница для неопознанных адресов;
- `settings` - страница с формами изменения настроек и смены пароля авторизованного пользователя.

Директория **shared** - универсальные компоненты бизнес-логики, диалоговые окна, layout-компоненты, директивы, пайпы, универсальные сервисы бизнес-логики:

- `components` - все универсальные компоненты:
    - `ad-grid` - универсальный компонент для вывода сетки объявлений;
        - `ad-grid-item` - компонент для вывода карточки одного объявления в сетке;
            - `image` - компонент для вывода превью изображения для карточки одного объявления;
    - `ad-sidebar-filters` - компонент для вывода сайдбара с фильтрами на странице с результатами поиска;
    - `ad-title` - компонент для вывода заголовка страницы с объявлениями;
    - `ad-top-filters` - компонент для вывода верхней панели фильтров на странице с результатами поиска;
        - `picked-filters` - компонент для вывода всех выбранных фильтров с возможностью их удаления;
    - `breadcrumbs` - компонент для вывода хлебных крошек;
    - `forms` - папка с компонентами, необходимых для форм:
        - `control-error` - компонент для вывода ошибок для FormControls;
        - `password-input` - компонент, формирующий текстовое поле для ввода пароля.
    - `image-gallery` - компонент для вывода галереи изображений на странице объявления;
    - `search-bar` - компонент для вывода верхней панели с формой поиска объявлений и фильтром категорий;
        - `category-menu` - компонент для вывода меню с фильтром категорий;
    - `svg-icon` - компонент-обертка для svg-иконок.
    - `top-bar` - компонент для вывода верхней панели с пользовательским меню.

- `dialogs` - компоненты диалоговых окон:
    - `dialog-container` - контейнер-компонент для всех диалоговых окон;
    - `info-dialog` - компонент для вывода простого диалогового окна с информацией;
    - `login-dialog` - компонент для вывода диалогового окна авторизации пользователя;
    - `password-dialog` - компонент для подтверждения пароля пользователя;
    - `register-dialog` - компонент для вывода диалогового окна регистрации нового пользователя;
    - `terms-of-service` - компонент с информацией о правилах пользования приложением.

- `layouts` - переиспользуемые layout-компоненты:
    - `header` - компонент для вывода шапки;
    - `main-layout` - основной компонент для всех страниц.

- `pipes` - вспомогательные пайпы:
    - `adverts-count.pipe` - пайп для вывода числа объявлений с правильным склонением;
    - `date-format.pipe` - пайп для форматирования даты объявления;
    - `image-from-id.pipe` - асинхронный пайп для получения Blob-изображения по переданному id изображения;
    - `images-from-ids.pipe` - асинхронный пайп для получения массива Blob-изображений по переданному массиву id изображений (для галереи);
    - `phone-format.pipe` - пайп для форматирования телефонного номера;
    - `price-format.pipe` - пайп для форматирования цены.

- `services` - все сервисы, необходимые для работы страниц, компонентов, диалоговых окон:
    - `advert.service` - сервис для работы с объявлениями;
    - `breadcrumbs.service` - сервис для формирования хлебных крошек;
    - `category.service` - сервис для работы с категориями;
    - `category.store.service` - сервис для хранения всех категорий;
    - `image.service` - сервис для работы с изображениями.

- `utils` - утилитарные вспомогательные функции:
    - `categories-transform.util` - преобразует массив категорий в дерево с вложенными childs;
    - `find-category-from-id.util` - функция для поиска категории по id в модифицированном древовидном массиве.

- `validators` - кастомные валидаторы:
    - `passwordsMatch.validator` - валидирует совпадение двух паролей.
