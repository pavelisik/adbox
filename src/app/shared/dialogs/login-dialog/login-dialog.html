<p-dialog
    header="Авторизация"
    [(visible)]="visible"
    modal="true"
    [draggable]="false"
    [resizable]="false"
    [closable]="true"
    (onShow)="onShow()"
    (onHide)="onClose()"
>
    <form [formGroup]="loginForm" (ngSubmit)="onSubmit()">
        <div>
            <input
                pInputText
                placeholder="Логин"
                formControlName="login"
                autocomplete="username"
                [invalid]="!!getControlError('login')"
                class="dialog-form__input"
            />
            @if (getControlError('login')) {
                <p-message severity="error" size="small" variant="simple">{{
                    getControlError('login')
                }}</p-message>
            }
        </div>
        <div>
            <div class="dialog-form__password-input">
                <input
                    pInputText
                    [type]="isPasswordVisible() ? 'text' : 'password'"
                    placeholder="Пароль"
                    formControlName="password"
                    autocomplete="current-password"
                    [invalid]="!!getControlError('password')"
                    class="dialog-form__input"
                />
                <span
                    class="dialog-form__password-eye-btn"
                    [title]="isPasswordVisible() ? 'Скрыть пароль' : 'Показать пароль'"
                    [class.active]="isPasswordVisible()"
                    (click)="isPasswordVisible.set(!isPasswordVisible())"
                >
                    <span
                        class="pi"
                        [class.pi-eye-slash]="!isPasswordVisible()"
                        [class.pi-eye]="isPasswordVisible()"
                    ></span>
                </span>
            </div>
            @if (getControlError('password')) {
                <p-message severity="error" size="small" variant="simple">{{
                    getControlError('password')
                }}</p-message>
            }
        </div>
        <div class="dialog-form__bottom-field">
            <div class="dialog-form__remember-me">
                <p-checkbox
                    inputId="rememberMe"
                    formControlName="rememberMe"
                    [binary]="true"
                ></p-checkbox>
                <label for="rememberMe">Запомнить меня</label>
            </div>
            <a [routerLink]="[]" class="dialog-form__link">Забыли пароль?</a>
        </div>
        @if (formError()) {
            <p-message severity="error" size="small" variant="simple">{{ formError() }}</p-message>
        }
        <button
            pButton
            type="submit"
            [label]="isLoading() ? 'Вход' : 'Войти'"
            [loading]="isLoading()"
            [disabled]="!isControlsCompleted() || (isSubmitted() && loginForm.invalid)"
        ></button>
    </form>
</p-dialog>
