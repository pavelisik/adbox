<p-dialog
    header="Авторизация"
    [(visible)]="visible"
    modal="true"
    [draggable]="false"
    [resizable]="false"
    [closable]="true"
    (onShow)="onShow()"
    (onHide)="onClose()"
>
    <form [formGroup]="loginForm" (ngSubmit)="onSubmit()" class="dialog-form">
        <div>
            <input
                pInputText
                placeholder="Логин"
                formControlName="login"
                autocomplete="username"
                [invalid]="isControlInvalid('login')"
            />
            <app-control-error
                [form]="loginForm"
                controlName="login"
                [isSubmitted]="isSubmitted()"
            ></app-control-error>
        </div>
        <div>
            <app-password-input
                [control]="loginForm.controls.password"
                [isInvalid]="isControlInvalid('password')"
                [(isPasswordVisible)]="isPasswordVisible"
                placeholder="Пароль"
            ></app-password-input>
            <app-control-error
                [form]="loginForm"
                controlName="password"
                [isSubmitted]="isSubmitted()"
            ></app-control-error>
        </div>
        <div class="dialog-form__bottom-field">
            <div class="dialog-form__remember-me">
                <p-checkbox
                    inputId="rememberMe"
                    formControlName="rememberMe"
                    [binary]="true"
                ></p-checkbox>
                <label for="rememberMe">Запомнить меня</label>
            </div>
            <a [routerLink]="[]" class="dialog-form__link">Забыли пароль?</a>
        </div>
        @if (formError()) {
            <p-message severity="error" size="small" variant="simple">{{ formError() }}</p-message>
        }
        <button
            pButton
            type="submit"
            [label]="isLoading() ? 'Вход' : 'Войти'"
            [loading]="isLoading()"
            [disabled]="!isControlsCompleted() || (isSubmitted() && loginForm.invalid)"
        ></button>
    </form>
</p-dialog>
